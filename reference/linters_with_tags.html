<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Make a new list based on all linters provided by packages and tagged with tags.
The result of this function is meant to be passed to the linters argument of lint(),
or to be put in your configuration file."><title>Create a tag-based linter configuration — linters_with_tags • lintr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a tag-based linter configuration — linters_with_tags"><meta property="og:description" content="Make a new list based on all linters provided by packages and tagged with tags.
The result of this function is meant to be passed to the linters argument of lint(),
or to be put in your configuration file."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="lintr.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lintr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/lintr.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/continuous-integration.html">Continuous integration</a>
    <a class="dropdown-item" href="../articles/creating_linters.html">Creating new linters</a>
    <a class="dropdown-item" href="../articles/editors.html">Editor setup</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/lintr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a tag-based linter configuration</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/lintr/blob/HEAD/R/with.R" class="external-link"><code>R/with.R</code></a></small>
      <div class="d-none name"><code>linters_with_tags.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Make a new list based on all linters provided by <code>packages</code> and tagged with <code>tags</code>.
The result of this function is meant to be passed to the <code>linters</code> argument of <code><a href="lint.html">lint()</a></code>,
or to be put in your configuration file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linters_with_tags</span><span class="op">(</span><span class="va">tags</span>, <span class="va">...</span>, packages <span class="op">=</span> <span class="st">"lintr"</span>, exclude_tags <span class="op">=</span> <span class="st">"deprecated"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tags</dt>
<dd><p>Optional character vector of tags to search. Only linters with at least one matching tag will be
returned. If <code>tags</code> is <code>NULL</code>, all linters will be returned.</p></dd>


<dt>...</dt>
<dd><p>Arguments of elements to change. If unnamed, the argument is automatically named.
If the named argument already exists in the list of linters, it is replaced by the new element.
If it does not exist, it is added. If the value is <code>NULL</code>, the linter is removed.</p></dd>


<dt>packages</dt>
<dd><p>A character vector of packages to search for linters.</p></dd>


<dt>exclude_tags</dt>
<dd><p>Tags to exclude from the results. Linters with at least one matching tag will not be returned.
If <code>except_tags</code> is <code>NULL</code>, no linters will be excluded.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A modified list of linters.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="linters_with_defaults.html">linters_with_defaults</a> for basing off lintr's set of default linters.
<a href="available_linters.html">available_linters</a> to get a data frame of available linters.
<a href="linters.html">linters</a> for a complete list of linters available in lintr.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># `linters_with_defaults()` and `linters_with_tags("default")` are the same:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="linters_with_defaults.html">linters_with_defaults</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">linters_with_tags</span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get all linters useful for package development</span></span></span>
<span class="r-in"><span><span class="fu">linters_with_tags</span><span class="op">(</span>tags <span class="op">=</span> <span class="st">"package_development"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $backport_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (all(r_version &gt;= R_system_version(names(backports)))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_names_nodes &lt;- xml2::xml_find_all(xml, names_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_names &lt;- xml2::xml_text(all_names_nodes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     needs_backport &lt;- do.call(rbind, lapply(backport_blacklist, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         function(nm) all_names %in% nm))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_idx &lt;- colSums(needs_backport) &gt; 0L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     needs_backport_version_idx &lt;- ((which(needs_backport) - 1L)%%length(backport_blacklist)) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf(paste("%s (R %s) is not available for dependency R &gt;= %s.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Use the `except` argument of `backport_linter()` to configure available backports."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         all_names[bad_idx], names(backport_blacklist)[needs_backport_version_idx], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         r_version)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(all_names_nodes[bad_idx], source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d92c4d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733d96f858&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "backport_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conjunct_test_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(bad_expr) == 0L) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_fun &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     operator &lt;- xml2::xml_find_chr(bad_expr, "string(expr/*[self::AND2 or self::OR2])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     replacement_fmt &lt;- ifelse(matched_fun %in% c("expect_true", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "expect_false"), "write multiple expectations like %1$s(A) and %1$s(B)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "write multiple conditions like %s(A, B).")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste(sprintf("Instead of %s(A %s B),", matched_fun, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         operator), sprintf(replacement_fmt, matched_fun), "The latter will produce better error messages in the case of failure.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d9334c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733da749a8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "conjunct_test_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_comparison_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comparator &lt;- xml2::xml_find_chr(bad_expr, "string(expr[2]/*[2])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     expectation &lt;- comparator_expectation_map[comparator]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("%s(x, y) is better than expect_true(x %s y).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         expectation, comparator)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d9373b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733daf5118&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_comparison_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_identical_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("Use expect_identical(x, y) by default; resort to expect_equal() only when needed,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "e.g. when setting ignore_attr= or tolerance=."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d93ac08&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733db6ce28&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_identical_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_length_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("expect_length(x, n) is better than %s(length(x), n)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_function)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d93c968&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733dbfdc10&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_length_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_named_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr, depth = 0L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("expect_named(x, n) is better than %s(names(x), n)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_function)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d93e4d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733dc5ed78&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_named_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_not_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "expect_false(x) is better than expect_true(!x), and vice versa.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d9402d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733dcbfff8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_not_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_null_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr, depth = 0L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(matched_function %in% c("expect_equal", "expect_identical"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("expect_null(x) is better than %s(x, NULL)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_function), "expect_null(x) is better than expect_true(is.null(x))")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = msg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d942000&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733dd1c408&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_null_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_s3_class_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(matched_function %in% c("expect_equal", "expect_identical"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("expect_s3_class(x, k) is better than %s(class(x), k).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_function), "expect_s3_class(x, k) is better than expect_true(is.&lt;k&gt;(x)) or expect_true(inherits(x, k)).")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = paste(msg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Note also expect_s4_class() available for testing S4 objects."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d946e38&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733dd7f2d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_s3_class_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_s4_class_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("expect_s4_class(x, k) is better than expect_true(is(x, k)).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "Note also expect_s3_class() available for testing S3 objects."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d948498&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ddf47a8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_s4_class_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_true_false_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     call_name &lt;- xp_call_name(bad_expr, condition = "starts-with(text(), 'expect_')")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     truth_value &lt;- xml2::xml_find_chr(bad_expr, "string(expr/NUM_CONST[text() = 'TRUE' or text() = 'FALSE'])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("expect_%s(x) is better than %s(x, %s)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tolower(truth_value), call_name, truth_value)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d94bdd0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733de58668&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_true_false_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_type_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(matched_function %in% c("expect_equal", "expect_identical"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("expect_type(x, t) is better than %s(typeof(x), t)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_function), "expect_type(x, t) is better than expect_true(is.&lt;t&gt;(x))")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = msg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d950ab8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733debcea0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_type_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $package_hooks_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_msg_call_lints &lt;- function(xml, hook) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         bad_expr &lt;- xml2::xml_find_all(xml, bad_call_xpaths[[hook]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message &lt;- make_bad_call_lint_message(bad_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             hook)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     onload_bad_msg_call_lints &lt;- bad_msg_call_lints(xml, ".onLoad")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     onattach_bad_msg_call_lints &lt;- bad_msg_call_lints(xml, ".onAttach")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     load_arg_name_expr &lt;- xml2::xml_find_all(xml, load_arg_name_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     load_arg_name_message &lt;- sprintf("%s() should take two arguments, with the first starting with 'lib' and the second starting with 'pkg'.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_chr(load_arg_name_expr, hook_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     load_arg_name_lints &lt;- xml_nodes_to_lints(load_arg_name_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, load_arg_name_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_expr &lt;- xml2::xml_find_all(xml, library_require_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_bad_call &lt;- xml2::xml_text(library_require_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_hook &lt;- xml2::xml_find_chr(library_require_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         hook_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_message &lt;- character(length(library_require_bad_call))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_installed_packages &lt;- library_require_bad_call == "installed.packages"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_message[is_installed_packages] &lt;- sprintf("Don't slow down package load by running installed.packages() in %s().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         library_require_hook)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_message[!is_installed_packages] &lt;- sprintf("Don't alter the search() path in %s() by calling %s().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         library_require_hook, library_require_bad_call)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_lints &lt;- xml_nodes_to_lints(library_require_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, library_require_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_unload_call_expr &lt;- xml2::xml_find_all(xml, bad_unload_call_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_unload_call_message &lt;- sprintf("Use library.dynam.unload() calls in .onUnload(), not %s().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_chr(bad_unload_call_expr, hook_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_unload_call_lints &lt;- xml_nodes_to_lints(bad_unload_call_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, bad_unload_call_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unload_arg_name_expr &lt;- xml2::xml_find_all(xml, unload_arg_name_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unload_arg_name_message &lt;- sprintf("%s() should take one argument starting with 'lib'.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_chr(unload_arg_name_expr, hook_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unload_arg_name_lints &lt;- xml_nodes_to_lints(unload_arg_name_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, unload_arg_name_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(c(onload_bad_msg_call_lints, onattach_bad_msg_call_lints, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         load_arg_name_lints, library_require_lints, bad_unload_call_lints, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         unload_arg_name_lints))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d95a9d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733df471f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "package_hooks_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $yoda_test_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     second_const &lt;- xml2::xml_find_first(bad_expr, second_const_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- ifelse(is.na(second_const), paste("Tests should compare objects in the order 'actual', 'expected', not the reverse.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("For example, do %1$s(foo(x), 2L) instead of %1$s(2L, foo(x)).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_call)), sprintf("Avoid storing placeholder tests like %s(1, 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_call))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d969660&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733dfb5158&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "yoda_test_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get all linters provided by lintr</span></span></span>
<span class="r-in"><span><span class="fu">linters_with_tags</span><span class="op">(</span>tags <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $absolute_path_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(ids_with_token(source_expression, "STR_CONST"), function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         token &lt;- with_id(source_expression, id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         path &lt;- get_r_string(token$text)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (path_function(path)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             start &lt;- token[["col1"]] + 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             end &lt;- token[["col2"]] - 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Lint(filename = source_expression[["filename"]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 line_number = token[["line1"]], column_number = start, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 type = "warning", message = message, line = source_expression[["lines"]][[as.character(token[["line1"]])]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ranges = list(c(start, end)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733dbac5e8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e1c6148&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "absolute_path_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $any_duplicated_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     any_duplicated_expr &lt;- xml2::xml_find_all(xml, any_duplicated_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     any_duplicated_lints &lt;- xml_nodes_to_lints(any_duplicated_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression = source_expression, lint_message = "anyDuplicated(x, ...) &gt; 0 is better than any(duplicated(x), ...).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     length_unique_expr &lt;- xml2::xml_find_all(xml, length_unique_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- ifelse(is.na(xml2::xml_find_first(length_unique_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         uses_nrow_xpath)), "anyDuplicated(x) == 0L is better than length(unique(x)) == length(x).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "anyDuplicated(DF$col) == 0L is better than length(unique(DF$col)) == nrow(DF)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     length_unique_lints &lt;- xml_nodes_to_lints(length_unique_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression = source_expression, lint_message = lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(c(any_duplicated_lints, length_unique_lints))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e12c818&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e2273c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "any_duplicated_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $any_is_na_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "anyNA(x) is better than any(is.na(x)).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e12dd60&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e293748&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "any_is_na_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $assignment_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(bad_expr) == 0L) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     operator &lt;- xml2::xml_text(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message_fmt &lt;- ifelse(operator %in% c("&lt;&lt;-", "-&gt;&gt;"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "%s can have hard-to-predict behavior; prefer assigning to a specific environment instead (with assign() or &lt;-).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Use &lt;-, not %s, for assignment.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf(lint_message_fmt, operator)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "style")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c6f70f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e31e988&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "assignment_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $backport_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (all(r_version &gt;= R_system_version(names(backports)))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_names_nodes &lt;- xml2::xml_find_all(xml, names_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_names &lt;- xml2::xml_text(all_names_nodes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     needs_backport &lt;- do.call(rbind, lapply(backport_blacklist, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         function(nm) all_names %in% nm))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_idx &lt;- colSums(needs_backport) &gt; 0L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     needs_backport_version_idx &lt;- ((which(needs_backport) - 1L)%%length(backport_blacklist)) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf(paste("%s (R %s) is not available for dependency R &gt;= %s.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Use the `except` argument of `backport_linter()` to configure available backports."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         all_names[bad_idx], names(backport_blacklist)[needs_backport_version_idx], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         r_version)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(all_names_nodes[bad_idx], source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d92c4d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e38bd98&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "backport_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $brace_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xp_open_curly), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Opening curly braces should never go on their own line and should always be followed by a new line."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xp_paren_brace), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "There should be a space before an opening curly brace."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xp_closed_curly), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Closing curly-braces should always be on their own line, unless they are followed by an else."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xp_else_same_line), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "`else` should come on the same line as the previous `}`."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xp_function_brace), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Any function spanning multiple lines should use curly braces."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xp_if_else_match_brace), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Either both or neither branch in `if`/`else` should use curly braces."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7aa188&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e462110&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "brace_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_equals_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     operator &lt;- xml2::xml_find_chr(bad_expr, "string(*[2])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("Instead of comparing class(x) with %s, use inherits(x, 'class-name') or is.&lt;class&gt; or is(x, 'class')", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         operator)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e12fc48&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e545ab0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "class_equals_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $commas_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     before_lints &lt;- xml_nodes_to_lints(xml2::xml_find_all(xml, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath_before), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Commas should never have a space before.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_start_xpath = "number(./preceding-sibling::*[1]/@col2 + 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_end_xpath = "number(./@col1 - 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     after_lints &lt;- xml_nodes_to_lints(xml2::xml_find_all(xml, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath_after), source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Commas should always have a space after.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_start_xpath = "number(./@col2 + 1)", range_end_xpath = "number(./@col2 + 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     c(before_lints, after_lints)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7addd0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e5a81a8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "commas_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $commented_code_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_comment_nodes &lt;- xml2::xml_find_all(source_expression$full_xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "//COMMENT")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_comments &lt;- xml2::xml_text(all_comment_nodes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     code_candidates &lt;- re_matches(all_comments, code_candidate_regex, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         global = FALSE, locations = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_parsable &lt;- which(vapply(code_candidates[, "code"], parsable, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         logical(1L)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_list &lt;- xml_nodes_to_lints(all_comment_nodes[is_parsable], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression = source_expression, lint_message = "Commented code should be removed.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     for (i in seq_along(lint_list)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rng &lt;- lint_list[[i]]$ranges[[1L]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rng[2L] &lt;- rng[1L] + code_candidates[is_parsable[i], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "code.end"] - 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rng[1L] &lt;- rng[1L] + code_candidates[is_parsable[i], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "code.start"] - 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_list[[i]]$column_number &lt;- rng[1L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_list[[i]]$ranges &lt;- list(rng)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7b10b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e606c10&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "commented_code_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $condition_message_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sep_value &lt;- get_r_string(bad_expr, xpath = "./expr/SYMBOL_SUB[text() = 'sep']/following-sibling::expr/STR_CONST")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- bad_expr[is.na(sep_value) | sep_value %in% c("", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         " ")]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     outer_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     inner_call &lt;- xp_call_name(bad_expr, depth = 2L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste("Don't use", inner_call, "to build", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         outer_call, "strings.", "Instead use the fact that these functions build condition message strings from their input", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "(using \"\" as a separator). For translatable strings, prefer using gettextf().")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e134850&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e6eed98&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "condition_message_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conjunct_test_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(bad_expr) == 0L) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_fun &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     operator &lt;- xml2::xml_find_chr(bad_expr, "string(expr/*[self::AND2 or self::OR2])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     replacement_fmt &lt;- ifelse(matched_fun %in% c("expect_true", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "expect_false"), "write multiple expectations like %1$s(A) and %1$s(B)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "write multiple conditions like %s(A, B).")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste(sprintf("Instead of %s(A %s B),", matched_fun, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         operator), sprintf(replacement_fmt, matched_fun), "The latter will produce better error messages in the case of failure.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d9334c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e76e3d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "conjunct_test_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $consecutive_stopifnot_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Unify consecutive calls to stopifnot().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e135b30&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e833de0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "consecutive_stopifnot_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cyclocomp_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     complexity &lt;- try_silently(cyclocomp::cyclocomp(parse(text = source_expression$content)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(complexity, "try-error") || complexity &lt;= complexity_limit) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     col1 &lt;- source_expression[["column"]][1L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Lint(filename = source_expression[["filename"]], line_number = source_expression[["line"]][1L], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         column_number = source_expression[["column"]][1L], type = "style", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         message = sprintf("Functions should have cyclomatic complexity of less than %d, this has %d.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             complexity_limit, complexity), ranges = list(rep(col1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             2L)), line = source_expression$lines[1L])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7b7b30&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e8ab058&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cyclocomp_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $duplicate_argument_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- xml2::xml_find_all(xml, xpath_call_with_args)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(except)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         calls_text &lt;- get_r_string(xp_call_name(calls))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         calls &lt;- calls[!(calls_text %in% except)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_arg_nodes &lt;- lapply(calls, function(call_node) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_all(call_node, xpath_arg_name)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     arg_names &lt;- lapply(all_arg_nodes, get_r_string)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_duplicated &lt;- lapply(arg_names, duplicated)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(unlist(all_arg_nodes, recursive = FALSE)[unlist(is_duplicated)], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression = source_expression, lint_message = "Duplicate arguments in function call.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e13a818&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e90ddd0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "duplicate_argument_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $equals_na_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = "Use is.na for comparisons to NA (not == or !=)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7ba1d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e970c28&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "equals_na_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_comparison_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comparator &lt;- xml2::xml_find_chr(bad_expr, "string(expr[2]/*[2])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     expectation &lt;- comparator_expectation_map[comparator]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("%s(x, y) is better than expect_true(x %s y).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         expectation, comparator)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d9373b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733e9db108&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_comparison_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_identical_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("Use expect_identical(x, y) by default; resort to expect_equal() only when needed,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "e.g. when setting ignore_attr= or tolerance=."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d93ac08&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ea53c18&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_identical_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_length_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("expect_length(x, n) is better than %s(length(x), n)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_function)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d93c968&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ead25e0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_length_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_named_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr, depth = 0L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("expect_named(x, n) is better than %s(names(x), n)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_function)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d93e4d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733eb4a070&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_named_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_not_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "expect_false(x) is better than expect_true(!x), and vice versa.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d9402d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ebbc558&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_not_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_null_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr, depth = 0L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(matched_function %in% c("expect_equal", "expect_identical"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("expect_null(x) is better than %s(x, NULL)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_function), "expect_null(x) is better than expect_true(is.null(x))")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = msg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d942000&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b76f3b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_null_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_s3_class_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(matched_function %in% c("expect_equal", "expect_identical"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("expect_s3_class(x, k) is better than %s(class(x), k).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_function), "expect_s3_class(x, k) is better than expect_true(is.&lt;k&gt;(x)) or expect_true(inherits(x, k)).")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = paste(msg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Note also expect_s4_class() available for testing S4 objects."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d946e38&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b702210&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_s3_class_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_s4_class_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("expect_s4_class(x, k) is better than expect_true(is(x, k)).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "Note also expect_s3_class() available for testing S3 objects."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d948498&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b69c778&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_s4_class_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_true_false_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     call_name &lt;- xp_call_name(bad_expr, condition = "starts-with(text(), 'expect_')")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     truth_value &lt;- xml2::xml_find_chr(bad_expr, "string(expr/NUM_CONST[text() = 'TRUE' or text() = 'FALSE'])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("expect_%s(x) is better than %s(x, %s)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tolower(truth_value), call_name, truth_value)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d94bdd0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b574af8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_true_false_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $expect_type_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_function &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(matched_function %in% c("expect_equal", "expect_identical"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("expect_type(x, t) is better than %s(typeof(x), t)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_function), "expect_type(x, t) is better than expect_true(is.&lt;t&gt;(x))")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message = msg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d950ab8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b4ec7d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "expect_type_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $extraction_operator_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_exprs &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msgs &lt;- sprintf("Use `[[` instead of `%s` to extract an element.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_text(bad_exprs))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_exprs, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = msgs, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e140818&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b459370&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "extraction_operator_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fixed_regex_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     patterns &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pattern_strings &lt;- get_r_string(patterns)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_static &lt;- is_not_regex(pattern_strings)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fixed_equivalent &lt;- encodeString(get_fixed_string(pattern_strings[is_static]), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         quote = "\"", justify = "none")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     call_name &lt;- xml2::xml_find_chr(patterns[is_static], "string(preceding-sibling::expr[last()]/SYMBOL_FUNCTION_CALL)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_stringr &lt;- startsWith(call_name, "str_")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     replacement &lt;- ifelse(is_stringr, sprintf("stringr::fixed(%s)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         fixed_equivalent), fixed_equivalent)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- paste("This regular expression is static, i.e., its matches can be expressed as a fixed substring expression, which", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "is faster to compute. Here, you can use", replacement, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ifelse(is_stringr, "as the pattern.", "with fixed = TRUE."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(patterns[is_static], source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = msg, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1446c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b3d6710&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fixed_regex_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $function_left_parentheses_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_exprs &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_exprs, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Remove spaces before the left parenthesis in a function call.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_start_xpath = "number(./@col2 + 1)", range_end_xpath = "number(./following-sibling::OP-LEFT-PAREN/@col1 - 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7bc438&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b3407e0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "function_left_parentheses_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ifelse_censor_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     operator &lt;- xml2::xml_find_chr(bad_expr, "string(expr[2]/*[2])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     match_first &lt;- !is.na(xml2::xml_find_first(bad_expr, "expr[2][expr[1] = following-sibling::expr[1]]"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     optimizer &lt;- ifelse((operator %in% c("&lt;", "&lt;=")) == match_first, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "pmin", "pmax")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     first_var &lt;- rep_len("x", length(match_first))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     second_var &lt;- rep_len("y", length(match_first))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     first_var[!match_first] &lt;- "y"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     second_var[!match_first] &lt;- "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = sprintf("%s(x, y) is preferable to %s(x %s y, %s, %s).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             optimizer, matched_call, operator, first_var, second_var), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e149a50&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b2bdb20&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ifelse_censor_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $implicit_integer_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     numbers &lt;- xml2::xml_find_all(xml, "//NUM_CONST")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(numbers[is_implicit_integer(xml2::xml_text(numbers))], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression = source_expression, lint_message = "Integers should not be implicit. Use the form 1L for integers or 1.0 for doubles.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "style", column_number_xpath = "number(./@col2 + 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_end_xpath = "number(./@col2 + 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e14fba0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b234360&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "implicit_integer_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $infix_spaces_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "style")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7c1778&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b1b0a18&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "infix_spaces_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inner_combine_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(bad_expr, depth = 2L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste("Combine inputs to vectorized functions first to take full advantage of vectorization, e.g.,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("%1$s(c(x, y)) only runs the more expensive %1$s() once as compared to c(%1$s(x), %1$s(y)).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_call))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e152e48&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733affc4f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "inner_combine_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $line_length_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     line_lengths &lt;- nchar(source_expression$file_lines)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     long_lines &lt;- which(line_lengths &gt; length)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("Lines should not be more than %d characters.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         length)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(long_lines, function(long_line) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Lint(filename = source_expression$filename, line_number = long_line, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             column_number = length + 1L, type = "style", message = lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             line = source_expression$file_lines[long_line], ranges = list(c(1L, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 line_lengths[long_line])))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d95cc88&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ae68c90&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "line_length_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $literal_coercion_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("Use literals directly where possible, instead of coercion.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "c.f. 1L instead of as.integer(1), or NA_real_ instead of as.numeric(NA)."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e154518&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733adece30&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "literal_coercion_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $missing_argument_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     missing_args &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     function_call_name &lt;- get_r_string(xml2::xml_find_chr(missing_args, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         to_function_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(missing_args[!function_call_name %in% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         except], source_expression = source_expression, lint_message = "Missing argument in function call.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e159740&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ad42e40&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "missing_argument_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $missing_package_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkg_calls &lt;- xml2::xml_find_all(xml, call_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkg_names &lt;- get_r_string(xml2::xml_find_all(pkg_calls, "OP-LEFT-PAREN[1]/following-sibling::expr[1][SYMBOL | STR_CONST]"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     installed_packges &lt;- .packages(all.available = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     missing_pkgs &lt;- !(pkg_names %in% installed_packges)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(pkg_calls[missing_pkgs], source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = sprintf("Package '%s' is not installed.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             pkg_names[missing_pkgs]), type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e15a978&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733abe5b18&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "missing_package_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $namespace_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ns_nodes &lt;- xml2::xml_find_all(xml, "//NS_GET | //NS_GET_INT")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(ns_nodes) == 0L) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     package_nodes &lt;- xml2::xml_find_all(ns_nodes, "preceding-sibling::*[1]")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     packages &lt;- get_r_string(package_nodes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     installed_packages &lt;- .packages(all.available = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     installed &lt;- packages %in% installed_packages</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!all(installed)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, xml_nodes_to_lints(package_nodes[!installed], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             source_expression = source_expression, lint_message = sprintf("Package '%s' is not installed.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 packages[!installed]), type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ns_nodes &lt;- ns_nodes[installed]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         packages &lt;- packages[installed]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         package_nodes &lt;- package_nodes[installed]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!check_exports &amp;&amp; !check_nonexports) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(lints)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     namespaces &lt;- lapply(packages, function(package) tryCatch(getNamespace(package), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         error = identity))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     failed_namespace &lt;- vapply(namespaces, inherits, "condition", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         FUN.VALUE = logical(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (any(failed_namespace)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, xml_nodes_to_lints(package_nodes[failed_namespace], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             source_expression = source_expression, lint_message = vapply(namespaces[failed_namespace], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 conditionMessage, character(1L)), type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ns_nodes &lt;- ns_nodes[!failed_namespace]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         packages &lt;- packages[!failed_namespace]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         namespaces &lt;- namespaces[!failed_namespace]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ns_get &lt;- xml2::xml_text(ns_nodes) == "::"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     symbol_nodes &lt;- xml2::xml_find_all(ns_nodes, "following-sibling::*[1]")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     symbols &lt;- get_r_string(symbol_nodes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (check_nonexports) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, build_ns_get_int_lints(packages[!ns_get], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             symbols[!ns_get], symbol_nodes[!ns_get], namespaces[!ns_get], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             source_expression))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (check_exports) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, build_ns_get_lints(packages[ns_get], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             symbols[ns_get], symbol_nodes[ns_get], namespaces[ns_get], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             source_expression))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1657e8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733aa0e0c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "namespace_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nested_ifelse_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste(sprintf("Don't use nested %s() calls;", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_call), "instead, try (1) data.table::fcase; (2) dplyr::case_when; or (3) using a lookup table.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e16a160&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a8abad8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nested_ifelse_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $no_tab_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all_matches &lt;- re_matches(source_expression[["lines"]], regex, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         locations = TRUE, global = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     line_numbers &lt;- as.integer(names(source_expression[["lines"]]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- Map(function(line_matches, line_number) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lapply(split(line_matches, seq_len(nrow(line_matches))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             function(.match) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 if (is.na(.match[["start"]]) || .in_ignorable_position(source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   line_number, .match)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   return()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 start &lt;- .match[["start"]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 end &lt;- .match[["end"]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Lint(filename = source_expression[["filename"]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   line_number = line_number, column_number = start, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   type = lint_type, message = lint_msg, line = source_expression[["lines"]][[as.character(line_number)]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   ranges = list(c(start, end)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }, all_matches, line_numbers)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Filter(function(x) any(lengths(x) &gt; 0L), lints)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c7c2208&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a6e8420&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "no_tab_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nonportable_path_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(ids_with_token(source_expression, "STR_CONST"), function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         token &lt;- with_id(source_expression, id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         path &lt;- get_r_string(token$text)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (path_function(path)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             start &lt;- token[["col1"]] + 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             end &lt;- token[["col2"]] - 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Lint(filename = source_expression[["filename"]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 line_number = token[["line1"]], column_number = start, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 type = "warning", message = message, line = source_expression[["lines"]][[as.character(token[["line1"]])]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ranges = list(c(start, end)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733dbac5e8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a606508&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nonportable_path_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $numeric_leading_zero_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Include the leading zero for fractional numeric constants.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e16e5c0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a3d44b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "numeric_leading_zero_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $object_length_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assignments &lt;- xml2::xml_find_all(xml, object_name_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nms &lt;- strip_names(xml2::xml_text(assignments))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ns_imports &lt;- namespace_imports(find_package(source_expression$filename))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     generics &lt;- strip_names(c(declared_s3_generics(xml), imported_s3_generics(ns_imports)$fun, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         .base_s3_generics))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     generics &lt;- unique(generics[nzchar(generics)])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nms_stripped &lt;- re_substitutes(nms, rex(start, or(generics), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "."), "")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     too_long &lt;- nchar(nms_stripped) &gt; length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(assignments[too_long], source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "style")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c207e70&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a316b90&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "object_length_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $object_name_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assignments &lt;- xml2::xml_find_all(xml, object_name_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nms &lt;- strip_names(xml2::xml_text(assignments))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     generics &lt;- c(declared_s3_generics(xml), imported_s3_generics(namespace_imports(find_package(source_expression$filename)))$fun, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         .base_s3_generics)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     generics &lt;- unique(generics[nzchar(generics)])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style_matches &lt;- lapply(styles, function(style) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         check_style(nms, style, generics)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matches_a_style &lt;- Reduce(`|`, style_matches)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(assignments[!matches_a_style], source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = lint_message, type = "style")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733da80d38&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a28f748&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "object_name_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $object_usage_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkg_name &lt;- pkg_name(find_package(dirname(source_expression$filename)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     env &lt;- make_check_env(pkg_name)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     declared_globals &lt;- try_silently(utils::globalVariables(package = pkg_name %||% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         globalenv()))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     symbols &lt;- c(get_assignment_symbols(xml), get_imported_symbols(xml))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     for (symbol in symbols) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         assign(symbol, function(...) invisible(), envir = env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fun_assignments &lt;- xml2::xml_find_all(xml, xpath_function_assignment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(fun_assignments, function(fun_assignment) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         code &lt;- get_content(lines = source_expression$content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             fun_assignment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         fun &lt;- try_silently(eval(envir = env, parse(text = code, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             keep.source = TRUE)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (inherits(fun, "try-error")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             return()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         known_used_symbols &lt;- get_used_symbols(fun_assignment, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             interpret_glue = interpret_glue)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         res &lt;- parse_check_usage(fun, known_used_symbols = known_used_symbols, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             declared_globals = declared_globals, start_line = as.integer(xml2::xml_attr(fun_assignment, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 "line1")))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         res$name &lt;- rex::re_substitutes(res$name, rex::rex("&lt;-"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lintable_symbols &lt;- xml2::xml_find_all(fun_assignment, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "descendant::SYMBOL | descendant::SYMBOL_FUNCTION_CALL")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lintable_symbol_names &lt;- gsub("^`|`$", "", get_r_string(lintable_symbols))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lintable_symbol_lines &lt;- as.integer(xml2::xml_attr(lintable_symbols, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "line1"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_symbol &lt;- vapply(seq_len(nrow(res)), function(i) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             match(TRUE, lintable_symbol_names == res$name[i] &amp; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 lintable_symbol_lines &gt;= res$line1[i] &amp; lintable_symbol_lines &lt;= </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 res$line2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }, integer(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         nodes &lt;- unclass(lintable_symbols)[matched_symbol]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         nodes[is.na(matched_symbol)] &lt;- list(fun_assignment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml_nodes_to_lints(nodes, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             lint_message = res$message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c20ca88&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a1ab3c0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "object_usage_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $outer_negation_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     inverse_call &lt;- ifelse(matched_call == "any", "all", "any")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste(sprintf("!%s(x) is better than %s(!x).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         inverse_call, matched_call), "The former applies negation only once after aggregation instead of many times for each element of x.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1701d0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733a0ff8f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "outer_negation_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $package_hooks_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_msg_call_lints &lt;- function(xml, hook) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         bad_expr &lt;- xml2::xml_find_all(xml, bad_call_xpaths[[hook]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message &lt;- make_bad_call_lint_message(bad_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             hook)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     onload_bad_msg_call_lints &lt;- bad_msg_call_lints(xml, ".onLoad")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     onattach_bad_msg_call_lints &lt;- bad_msg_call_lints(xml, ".onAttach")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     load_arg_name_expr &lt;- xml2::xml_find_all(xml, load_arg_name_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     load_arg_name_message &lt;- sprintf("%s() should take two arguments, with the first starting with 'lib' and the second starting with 'pkg'.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_chr(load_arg_name_expr, hook_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     load_arg_name_lints &lt;- xml_nodes_to_lints(load_arg_name_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, load_arg_name_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_expr &lt;- xml2::xml_find_all(xml, library_require_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_bad_call &lt;- xml2::xml_text(library_require_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_hook &lt;- xml2::xml_find_chr(library_require_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         hook_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_message &lt;- character(length(library_require_bad_call))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_installed_packages &lt;- library_require_bad_call == "installed.packages"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_message[is_installed_packages] &lt;- sprintf("Don't slow down package load by running installed.packages() in %s().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         library_require_hook)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_message[!is_installed_packages] &lt;- sprintf("Don't alter the search() path in %s() by calling %s().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         library_require_hook, library_require_bad_call)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     library_require_lints &lt;- xml_nodes_to_lints(library_require_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, library_require_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_unload_call_expr &lt;- xml2::xml_find_all(xml, bad_unload_call_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_unload_call_message &lt;- sprintf("Use library.dynam.unload() calls in .onUnload(), not %s().", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_chr(bad_unload_call_expr, hook_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_unload_call_lints &lt;- xml_nodes_to_lints(bad_unload_call_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, bad_unload_call_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unload_arg_name_expr &lt;- xml2::xml_find_all(xml, unload_arg_name_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unload_arg_name_message &lt;- sprintf("%s() should take one argument starting with 'lib'.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml2::xml_find_chr(unload_arg_name_expr, hook_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unload_arg_name_lints &lt;- xml_nodes_to_lints(unload_arg_name_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression, unload_arg_name_message, type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(c(onload_bad_msg_call_lints, onattach_bad_msg_call_lints, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         load_arg_name_lints, library_require_lints, bad_unload_call_lints, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         unload_arg_name_lints))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d95a9d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339fb5820&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "package_hooks_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $paren_body_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_expressions &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(matched_expressions, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "There should be a space between a right parenthesis and a body expression.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c21bdc8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339eb12c0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "paren_body_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $paste_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!allow_empty_sep) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         empty_sep_expr &lt;- xml2::xml_find_all(xml, sep_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep_value &lt;- get_r_string(empty_sep_expr, xpath = "./SYMBOL_SUB[text() = 'sep']/following-sibling::expr[1]")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, xml_nodes_to_lints(empty_sep_expr[!nzchar(sep_value)], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             source_expression = source_expression, lint_message = "paste0(...) is better than paste(..., sep = \"\").", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!allow_to_string) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         to_string_expr &lt;- xml2::xml_find_all(xml, to_string_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         collapse_value &lt;- get_r_string(to_string_expr, xpath = "./SYMBOL_SUB[text() = 'collapse']/following-sibling::expr[1]")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, xml_nodes_to_lints(to_string_expr[collapse_value == </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ", "], source_expression = source_expression, lint_message = paste("toString(.) is more expressive than paste(., collapse = \", \").", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "Note also glue::glue_collapse() and and::and()", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "for constructing human-readable / translation-friendly lists"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     paste0_sep_expr &lt;- xml2::xml_find_all(xml, paste0_sep_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(paste0_sep_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "sep= is not a formal argument to paste0(); did you mean to use paste(), or collapse=?", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e175c90&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339e1d8c0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "paste_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pipe_call_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Use explicit calls in magrittr pipes, i.e., `a %&gt;% foo` should be `a %&gt;% foo()`.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e17a198&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339d1ef18&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "pipe_call_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pipe_continuation_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     x &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pipe_exprs &lt;- xml_find_all(x, multiline_pipe_test)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(pipe_exprs, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("`%&gt;%` should always have a space before it and a new line after it,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "unless the full pipeline fits on one line."), type = "style")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c21a040&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339c7c888&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "pipe_continuation_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $redundant_ifelse_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tf_expr &lt;- xml2::xml_find_all(xml, tf_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(tf_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     first_arg &lt;- xml2::xml_find_chr(tf_expr, "string(expr[3]/NUM_CONST)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     second_arg &lt;- xml2::xml_find_chr(tf_expr, "string(expr[4]/NUM_CONST)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tf_message &lt;- sprintf("Just use the logical condition (or its negation) directly instead of calling %s(x, %s, %s)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_call, first_arg, second_arg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(tf_expr, source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tf_message, type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!allow10) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         num_expr &lt;- xml2::xml_find_all(xml, num_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_call &lt;- xp_call_name(num_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         first_arg &lt;- xml2::xml_find_chr(num_expr, "string(expr[3]/NUM_CONST)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         second_arg &lt;- xml2::xml_find_chr(num_expr, "string(expr[4]/NUM_CONST)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         replacement &lt;- ifelse(first_arg %in% c("0", "1") | second_arg %in% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             c("0", "1"), "as.numeric", "as.integer")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message &lt;- paste(sprintf("Prefer %s(x) to %s(x, %s, %s) if really needed,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             replacement, matched_call, first_arg, second_arg), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "but do note that R will usually convert logical vectors to 0/1 on the fly when needed.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, xml_nodes_to_lints(num_expr, source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             lint_message, type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(lints)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e17dd70&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339c05048&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "redundant_ifelse_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $regex_subset_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     grep_expr &lt;- xml2::xml_find_all(xml, grep_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     grep_lints &lt;- xml_nodes_to_lints(grep_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Prefer grep(pattern, x, ..., value = TRUE) over x[grep(pattern, x, ...)] and x[grepl(pattern, x, ...)].", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     stringr_expr &lt;- xml2::xml_find_all(xml, stringr_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     stringr_lints &lt;- xml_nodes_to_lints(stringr_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Prefer stringr::str_subset(x, pattern) over x[str_detect(x, pattern)] and x[str_which(x, pattern)].", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(c(grep_lints, stringr_lints))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e183b08&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339af8068&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "regex_subset_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $semicolon_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_exprs &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (need_detection) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         is_trailing &lt;- is.na(xml2::xml_find_first(bad_exprs, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             compound_xpath))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         msg &lt;- ifelse(is_trailing, msg_trailing, msg_compound)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_exprs, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = msg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c21eac0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339a57108&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "semicolon_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seq_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     badx &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dot_expr1 &lt;- get_fun(badx, 1L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dot_expr2 &lt;- get_fun(badx, 2L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     replacement &lt;- ifelse(grepl("length(", dot_expr1, fixed = TRUE) | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         grepl("length(", dot_expr2, fixed = TRUE), "seq_along", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "seq_len")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("%s:%s is likely to be wrong in the empty edge case. Use %s() instead.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dot_expr1, dot_expr2, replacement)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(badx, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c2251f8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733999b408&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "seq_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $single_quotes_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     content &lt;- source_expression$full_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     str_idx &lt;- which(content$token == "STR_CONST")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     squote_matches &lt;- which(re_matches(content[str_idx, "text"], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         squote_regex))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(squote_matches, function(id) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         with(content[str_idx[id], ], {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             line &lt;- source_expression$file_lines[[line1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             col2 &lt;- if (line1 == line2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 col2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             else nchar(line)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Lint(filename = source_expression$filename, line_number = line1, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 column_number = col1, type = "style", message = "Only use double-quotes.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 line = line, ranges = list(c(col1, col2)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c229118&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557339391050&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "single_quotes_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $spaces_inside_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     left_expr &lt;- xml2::xml_find_all(xml, left_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     left_msg &lt;- ifelse(xml2::xml_text(left_expr) == "[", "Do not place spaces after square brackets.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Do not place spaces after parentheses.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     left_lints &lt;- xml_nodes_to_lints(left_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = left_msg, range_start_xpath = "number(./@col2 + 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_end_xpath = "number(./following-sibling::*[1]/@col1 - 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     right_expr &lt;- xml2::xml_find_all(xml, right_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     right_msg &lt;- ifelse(xml2::xml_text(right_expr) == "]", "Do not place spaces before square brackets.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Do not place spaces before parentheses.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     right_lints &lt;- xml_nodes_to_lints(right_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = right_msg, range_start_xpath = "number(./preceding-sibling::*[1]/@col2 + 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         range_end_xpath = "number(./@col1 - 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     c(left_lints, right_lints)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c96fc68&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557338e333c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "spaces_inside_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $spaces_left_parentheses_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath &lt;- file_level_xpath</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath &lt;- expression_level_xpath</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_paren &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_paren, source_expression, lint_message = "Place a space before left parenthesis, except in a function call.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "style")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c973418&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557338b6b9f8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "spaces_left_parentheses_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sprintf_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sprintf_calls &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     message &lt;- vapply(sprintf_calls, capture_sprintf_warning, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         character(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     has_message &lt;- !is.na(message)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(sprintf_calls[has_message], source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = message[has_message], type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e184fa8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557338361710&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sprintf_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $string_boundary_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     str_detect_lint_data &lt;- get_regex_lint_data(xml, str_detect_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     str_detect_lint_message &lt;- paste(ifelse(str_detect_lint_data$initial_anchor, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Use startsWith() to detect a fixed initial substring.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Use endsWith() to detect a fixed terminal substring."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Doing so is more readable and more efficient.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(str_detect_lint_data$lint_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         source_expression = source_expression, lint_message = str_detect_lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!allow_grepl) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         grepl_lint_data &lt;- get_regex_lint_data(xml, grepl_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         grepl_replacement &lt;- ifelse(grepl_lint_data$initial_anchor, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "startsWith", "endsWith")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         grepl_type &lt;- ifelse(grepl_lint_data$initial_anchor, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "initial", "terminal")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         grepl_lint_message &lt;- paste(sprintf("Use !is.na(x) &amp; %s(x, string) to detect a fixed %s substring, or, if missingness is not a concern, just %s.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             grepl_replacement, grepl_type, grepl_replacement), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "Doing so is more readable and more efficient.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints &lt;- c(lints, xml_nodes_to_lints(grepl_lint_data$lint_expr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             source_expression = source_expression, lint_message = grepl_lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     substr_expr &lt;- xml2::xml_find_all(xml, substr_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     substr_one &lt;- xml2::xml_find_chr(substr_expr, substr_arg2_xpath) %in% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         c("1", "1L")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     substr_lint_message &lt;- paste(ifelse(substr_one, "Use startsWith() to detect an initial substring.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Use endsWith() to detect a terminal substring."), "Doing so is more readable and more efficient.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- c(lints, xml_nodes_to_lints(substr_expr, source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         substr_lint_message, type = "warning"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e18f2b8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557337f64c78&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "string_boundary_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $strings_as_factors_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = paste("This code relies on the default value of stringsAsFactors,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "which changed in version R 4.0. Please supply an explicit value for", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "stringsAsFactors for this code to work with versions of R both before", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "and after this switch."), type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e198198&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557336f6b7e0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "strings_as_factors_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $system_file_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     outer_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- paste("Use the `...` argument of system.file() to expand paths,", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "e.g. system.file(\"data\", \"model.csv\", package = \"myrf\") instead of", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ifelse(outer_call == "system.file", "system.file(file.path(\"data\", \"model.csv\"), package = \"myrf\")", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "file.path(system.file(package = \"myrf\"), \"data\", \"model.csv\")"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e199e18&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557337cf09b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "system_file_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T_and_F_symbol_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_exprs &lt;- xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_assigns &lt;- xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath_assignment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     make_lints &lt;- function(expr, fmt) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         symbol &lt;- xml2::xml_text(expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message &lt;- sprintf(fmt, replacement_map[symbol], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             symbol)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xml_nodes_to_lints(xml = expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             lint_message = lint_message, type = "style", column_number_xpath = "number(./@col2 + 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             range_end_xpath = "number(./@col2 + 1)")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     c(make_lints(bad_exprs, "Use %s instead of the symbol %s."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         make_lints(bad_assigns, "Don't use %2$s as a variable name, as it can break code relying on %2$s being %1$s."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c978020&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557336e744c8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "T_and_F_symbol_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $todo_comment_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tokens &lt;- with_id(source_expression, ids_with_token(source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "COMMENT"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     are_todo &lt;- re_matches(tokens[["text"]], todo_comment_regex, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ignore.case = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tokens &lt;- tokens[are_todo, ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(split(tokens, seq_len(nrow(tokens))), function(token) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Lint(filename = source_expression[["filename"]], line_number = token[["line1"]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             column_number = token[["col1"]], type = "style", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             message = "TODO comments should be removed.", line = source_expression[["lines"]][[as.character(token[["line1"]])]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             ranges = list(c(token[["col1"]], token[["col2"]])))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e19aa68&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733691a390&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "todo_comment_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trailing_blank_lines_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     blanks &lt;- re_matches(source_expression$file_lines, rex(start, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         any_spaces, end))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     line_number &lt;- length(source_expression$file_lines)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     while (line_number &gt; 0L &amp;&amp; (is.na(blanks[[line_number]]) || </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         isTRUE(blanks[[line_number]]))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (!is.na(blanks[[line_number]])) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             lints[[length(lints) + 1L]] &lt;- Lint(filename = source_expression$filename, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 line_number = line_number, column_number = 1L, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 type = "style", message = "Trailing blank lines are superfluous.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 line = source_expression$file_lines[[line_number]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         line_number &lt;- line_number - 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (identical(source_expression$terminal_newline, FALSE)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         last_line &lt;- tail(source_expression$file_lines, 1L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lints[[length(lints) + 1L]] &lt;- Lint(filename = source_expression$filename, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             line_number = length(source_expression$file_lines), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             column_number = nchar(last_line) %||% 0L + 1L, type = "style", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             message = "Missing terminal newline.", line = last_line)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d813028&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733c0df630&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "trailing_blank_lines_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trailing_whitespace_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     res &lt;- re_matches(source_expression$file_lines, rex(blanks, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         end), locations = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (isTRUE(allow_empty_lines)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         bad_lines &lt;- which(res$start &gt; 1L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         bad_lines &lt;- which(!is.na(res$start))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (isTRUE(allow_in_strings) &amp;&amp; !is.null(source_expression$full_xml_parsed_content)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         all_str_consts &lt;- xml2::xml_find_all(source_expression$full_xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "//STR_CONST")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         start_lines &lt;- as.integer(xml2::xml_attr(all_str_consts, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "line1"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         end_lines &lt;- as.integer(xml2::xml_attr(all_str_consts, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "line2"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         is_in_str &lt;- vapply(bad_lines, function(ln) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             any(start_lines &lt;= ln &amp; ln &lt; end_lines)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }, logical(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         bad_lines &lt;- bad_lines[!is_in_str]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lapply(bad_lines, function(line) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Lint(filename = source_expression$filename, line_number = line, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             column_number = res$start[[line]], type = "style", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             message = "Trailing whitespace is superfluous.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             line = source_expression$file_lines[[line]], ranges = list(c(res$start[[line]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 res$end[[line]])))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c980410&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b77d970&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "trailing_whitespace_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $undesirable_function_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_nodes &lt;- xml2::xml_find_all(source_expression$xml_parsed_content, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fun_names &lt;- get_r_string(matched_nodes)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msgs &lt;- vapply(stats::setNames(nm = unique(fun_names)), function(fun_name) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         msg &lt;- sprintf("Function \"%s\" is undesirable.", fun_name)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         alternative &lt;- fun[[fun_name]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (!is.na(alternative)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             msg &lt;- paste(msg, sprintf("As an alternative, %s.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 alternative))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         msg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }, character(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(matched_nodes, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = unname(msgs[fun_names]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1a32f0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b805bc0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "undesirable_function_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $undesirable_operator_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_op &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     operator &lt;- xml2::xml_text(bad_op)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- sprintf("Operator `%s` is undesirable.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         operator)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative &lt;- op[operator]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     has_alternative &lt;- !is.na(alternative)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message[has_alternative] &lt;- paste(lint_message[has_alternative], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         alternative[has_alternative])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_op, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1a9dc0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733b848268&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "undesirable_operator_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $unneeded_concatenation_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     c_calls &lt;- xml2::xml_find_all(xml, xpath_call)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     num_args &lt;- as.integer(xml2::xml_find_num(c_calls, num_args_xpath)) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         as.integer(!is.na(xml2::xml_find_first(c_calls, to_pipe_xpath)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_unneeded &lt;- num_args &lt;= 1L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     c_calls &lt;- c_calls[is_unneeded]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     num_args &lt;- num_args[is_unneeded]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg &lt;- ifelse(num_args == 0L, msg_empty, msg_const)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!allow_single_expression) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         is_single_expression &lt;- !is.na(xml2::xml_find_first(c_calls, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             path_to_non_constant))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         msg[is_single_expression] &lt;- msg_const_expr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(c_calls, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = msg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1b2a08&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733c9fd188&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "unneeded_concatenation_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $unreachable_code_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Code and comments coming after a top-level return() or stop() should be removed.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1b9108&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733ca71250&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "unreachable_code_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $unused_import_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "file")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$full_xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     import_exprs &lt;- xml2::xml_find_all(xml, import_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (length(import_exprs) == 0L) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     imported_pkgs &lt;- xml2::xml_find_chr(import_exprs, "string(expr[STR_CONST|SYMBOL])")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     imported_pkgs &lt;- as.character(parse(text = imported_pkgs, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         keep.source = FALSE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     used_symbols &lt;- xml2::xml_text(xml2::xml_find_all(xml, xp_used_symbols))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_used &lt;- vapply(imported_pkgs, function(pkg) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (pkg %in% except_packages || !requireNamespace(pkg, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             quietly = TRUE)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             return(TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         package_exports &lt;- getNamespaceExports(pkg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         any(package_exports %in% used_symbols)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }, logical(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_ns_used &lt;- vapply(imported_pkgs, function(pkg) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ns_usage &lt;- xml2::xml_find_first(xml, paste0("//SYMBOL_PACKAGE[text() = '", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             pkg, "']"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         !identical(ns_usage, xml2::xml_missing())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }, logical(1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is_unused &lt;- !is_used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (allow_ns_usage) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         is_unused[is_ns_used] &lt;- FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     import_exprs &lt;- import_exprs[is_unused]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     unused_packages &lt;- get_r_string(import_exprs, xpath = "expr[STR_CONST | SYMBOL]")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- ifelse(is_ns_used[is_unused][unused_packages], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         paste0("Package '", unused_packages, "' is only used by namespace. ", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             "Check that it is installed using loadNamespace() instead."), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         paste0("Package '", unused_packages, "' is attached but never used."))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(import_exprs, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733e1bbf50&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733cace7e0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "unused_import_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vector_logic_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression = source_expression, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lint_message = "Conditional expressions require scalar logical operators (&amp;&amp; and ||)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733c986950&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733cb2f1d8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vector_logic_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $yoda_test_linter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (source_expression) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is_lint_level(source_expression, "expression")) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         return(list())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml &lt;- source_expression$xml_parsed_content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     bad_expr &lt;- xml2::xml_find_all(xml, xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matched_call &lt;- xp_call_name(bad_expr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     second_const &lt;- xml2::xml_find_first(bad_expr, second_const_xpath)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lint_message &lt;- ifelse(is.na(second_const), paste("Tests should compare objects in the order 'actual', 'expected', not the reverse.", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sprintf("For example, do %1$s(foo(x), 2L) instead of %1$s(2L, foo(x)).", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             matched_call)), sprintf("Avoid storing placeholder tests like %s(1, 1)", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         matched_call))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xml_nodes_to_lints(bad_expr, source_expression, lint_message, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         type = "warning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55733d969660&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55733cb91988&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linter"   "function"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"name")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "yoda_test_linter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get all linters tagged as "default" from lintr and mypkg</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu">linters_with_tags</span><span class="op">(</span><span class="st">"default"</span>, packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lintr"</span>, <span class="st">"mypkg"</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jim Hester, Florent Angly, Russ Hyde, Michael Chirico, Kun Ren, Alexander Rosenstock.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

